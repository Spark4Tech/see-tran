{% if components %}
  {% for c in components %}
  <div class="relative group">
    <!-- Changed from anchor link to button to avoid 404 on /components/<id>; now loads details via HTMX -->
    <button type="button"
      data-component-card="1"
      aria-label="View details for {{ c.name }}"
      hx-get="/api/components/{{ c.id }}/details" hx-target="#component-details" hx-swap="innerHTML"
      class="group relative w-full text-left flex h-full flex-col overflow-hidden rounded-xl bg-slate-800/60 border border-slate-700/40 hover:bg-slate-800/80 hover:border-slate-500/50 transition shadow-sm hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 p-4 sm:p-5">

      {% if c.is_composite %}
      <span class="absolute top-2 right-2 z-10 text-[10px] px-2 py-0.5 rounded bg-blue-600/25 text-blue-200 font-medium border border-blue-500/30 pointer-events-none">
        Composite
      </span>
      {% endif %}

      <!-- Header -->
        <div class="flex items-start gap-2 min-w-0">
          <h3 class="min-w-0 text-white font-semibold text-base sm:text-lg leading-snug break-words [hyphens:auto] line-clamp-2"
              title="{{ c.name }}">
            {{ c.name }}
          </h3>
        </div>
        <div class="text-right shrink-0 text-xs text-slate-400">
          <span class="text-slate-300 font-medium">{{ c.version or '-' }}</span><br>
          <span>{{ c.deployment_date_str }}</span>
        </div>

      <!-- Body -->
      <p class="mt-2 text-slate-300 text-sm leading-snug break-words [hyphens:auto]">
        {{ c.functions_display }}
      </p>

      <!-- Meta -->
      <div class="mt-3 text-[11px] sm:text-sm text-slate-400 flex flex-wrap gap-x-3 gap-y-1">
        <span class="flex items-center gap-1 min-w-0">
          <span class="opacity-60">🏢</span>
          <span class="truncate" title="{{ c.vendor_name }}">{{ c.vendor_name }}</span>
        </span>
        <span class="flex items-center gap-1 min-w-0">
          <span class="opacity-60">🏛️</span>
          <span class="truncate" title="{{ c.agencies_display }}">{{ c.agencies_display }}</span>
        </span>
      </div>
    </button>
    <div class="absolute top-2 left-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1">
      <button class="px-1.5 py-1 rounded bg-slate-700/70 hover:bg-slate-600 text-[10px] text-white" title="Edit"
              hx-get="/api/components/{{ c.id }}/form" hx-target="#component-form-container" hx-swap="innerHTML"
              onclick="event.preventDefault(); event.stopPropagation();">
        Edit
      </button>
    </div>
  </div>
  {% endfor %}
{% else %}
  <div class="col-span-full text-center py-12">
    <div class="w-16 h-16 bg-slate-700 rounded-full flex items-center justify-center mx-auto mb-4">
      <svg class="w-8 h-8 text-slate-500" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"/>
      </svg>
    </div>
    <h3 class="text-lg font-medium text-slate-400 mb-2">No Components Found</h3>
    <p class="text-slate-500">Adjust your filters or add new components.</p>
  </div>
{% endif %}
